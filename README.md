关于神经网络在织物渲染应用的实习总结报告
本次实习围绕 “神经网络在织物渲染中的应用” 展开核心研究，通过与传统渲染方法、其他表面模型的横向对比，系统剖析了神经网络材质在织物渲染场景下的优势、现存缺陷及优化方向，为后续技术迭代提供实践参考。
一、	织物渲染简介
传统织物渲染通常将织物解构为多层级结构，按尺度从细到粗依次为 Fiber（纤维）、Ply（纱线股）、Yarn（纱线）、Cloth（面料）。其中，Fiber 作为最小结构单元，通过与其他 Fiber 相互缠绕形成 Ply；Ply 进一步与其他 Ply 缠绕构成 Yarn；最终 Yarn 以多种交织方式编织形成完整 Cloth。需特别注意的是，Fiber 的基础材质属性（如反射率、透明度）与各层级的几何形态（如缠绕密度、交织角度），共同决定了织物的最终视觉呈现效果。
当前织物渲染的核心挑战集中于两点：一是对织物多层级几何结构的精准还原，二是光线在织物内部及表面的多重散射计算。主流研究方法可分为两类：
1.	基于曲线的模型：显式表达 Fiber、Ply、Yarn 等微观元素，能实现高精度渲染，但渲染过程需消耗大量时间与内存资源，效率较低；
2.	基于表面的模型：采用数据驱动思路，直接将织物视为二维表面进行计算，可实现更高效的渲染，但对织物微观细节（如 Fiber 分布不均、Yarn 边缘凹凸）的还原能力仍有待提升。
二、	应用神经网络的织物渲染
以论文《Neural Appearance Model for Cloth Rendering》为核心研究对象，该研究创新性地将神经网络（MLP）与传统渲染结合，构建基于表面的织物渲染模型，将渲染过程拆解为 “直接反射”“直接透射”“多重散射” 三部分，具体实现逻辑如下：

1)	三部分渲染逻辑与技术方案
3.	直接反射：指光线与织物仅发生一次相交（含反射、折射），视觉上表现为织物的高光区域。该部分沿用传统解析方法，从 Fiber 层级出发，将 BSDF（双向散射分布函数）拆分为反射与折射两个子模块，并通过 “解耦轴向与横向角度分布” 的方式降低计算复杂度。
4.	直接透射：指光线不与织物相交而直接穿透，视觉上表现为织物的透明区域。传统渲染中，“判断光线与 Fiber 是否相交” 的步骤需占用大量计算资源，因此该论文采用 MLP 近似替代 —— 通过输入入射光线方向，由神经网络输出 “光线是否穿透织物” 的判断结果，大幅提升效率。
5.	多重散射：指光线在织物表面及内部发生多次弹射，视觉上表现为织物的细节纹理（如肌理感）。该部分同样采用 MLP 实现，以入射光线方向与出射光线方向为输入，直接输出对应的 BSDF 参数。
2)	MLP 训练与实验结果
MLP 的训练数据来源于基准多角度渲染结果：将立体角均匀划分后，对单根 Yarn 在每个立体角分区内采用传统渲染方法生成数据，以此作为训练样本。 

3)	神经网络方法的现存缺陷
尽管效率优势明显，但该方法仍存在三方面核心问题：
6.	微观层级失真：在 Cloth 层级渲染效果良好，但聚焦至单根 Yarn 时失真明显 —— 现实中 Yarn 表面的 Fiber 分布不均、存在空隙且边缘凹凸，而该模型因训练输入仅包含 “入射 / 出射光线方向”（与入射点位置无关），默认 Fiber 在 Yarn 上均匀分布，最终呈现平滑表面，无法还原微观几何细节；
7.	参数灵活性不足：神经网络结构与 Fiber 的具体参数（密度、缠绕方式、反射率）强绑定，若需微调织物参数，需重新训练网络，而网络训练本身耗时较长；
8.	LOD 适配性弱：与传统方法相比，神经网络在 LOD（细节层次）调整上灵活性不足，尤其当 Yarn 在画面中仅占据 1 个像素时，问题更为突出。

三、	其他基于表面的模型
为进一步对比 “神经网络方案” 与传统表面模型的差异，本次实习还研究了两篇代表性论文，梳理其技术思路与可借鉴方向：
《A Realistic Surface-based Cloth Rendering Model》该论文未采用神经网络，而是通过 “统计分析 + 预计算” 的方式实现表面模型渲染，核心特点如下：
1.	渲染精度：在 Cloth 层级实现了准确渲染，但未针对 Yarn 层级开展测试验证；
2.	对比方式：直接与真实布料进行视觉对比，通过测量获取多类特征图，包括 ID map（标记表面是否存在织物区域）、Ply normal/tangent map（纱线股法向量 / 切向量图）、position map（纱线股相对基准面的偏移图）——特征图的引入有效避免了微观几何细节缺失的问题；
3.	局限与借鉴：该论文未开源代码，无法参考具体实现逻辑，但为前文神经网络模型提供优化思路：可通过传统渲染生成特征图数据样本（类似渲染图片，仅修改 Fiber 反射率即可），再将特征图融入模型训练，具体优化方向包括：
a)	直接反射部分：额外过滤 ID map 中值为 0 的渲染点，并结合 normal/position map 修正法线与位移参数；
b)	直接透射与多重散射部分：将特征图编码后作为 MLP 的输入，在控制 MLP 参数数量增幅不大的前提下，提升模型对空间变化的适配能力。
受实习周期限制，上述优化方案的具体实现仍处于探索阶段，实际渲染效果需后续测试验证。

《A Realistic Multi-scale Surface-based Cloth Appearance Model》该论文以《A Realistic Surface-based Cloth Rendering Model》为基础，新增两项关键功能：一是实现视差效果，二是还原织物边缘的绒毛细节；同时采用 “低耦合设计”，新增模块与原有渲染逻辑的关联性较弱，可独立调整。若将该模型作为基准参考，能进一步提升织物渲染结果的真实度与准确性。
四、	总结
本次实习围绕 “神经网络在织物渲染中的应用”，通过文献研究与技术对比，完成核心工作如下：
1)	核心研究成果
剖析《Neural Appearance Model for Cloth Rendering》技术逻辑，明确神经网络渲染的优势（降本提效）与缺陷（微观失真、参数僵化、LOD 适配弱）；对比两类传统表面模型，提炼 “特征图辅助渲染” 思路，为解决神经网络细节缺失问题提供路径。 
2)	现存不足与后续方向
受实习时间与资源限制，仍存在未完成事项：一是 “特征图 + MLP” 方案未落地验证；二是未复现特征图生成逻辑；三是 Yarn 层级 LOD 优化未深入。后续将推进模型开发测试、自主生成特征图样本，并探索神经网络与传统 LOD 的融合方案。
3)	实习收获
本次实习不仅掌握了织物渲染的核心技术框架（曲线模型、表面模型、神经网络方案），还提升了 “文献拆解 - 问题分析 - 方案设计” 的实践能力。特别感谢实习期间各位前辈的悉心指导，在技术难点拆解、研究方向把控上给予的关键支持，帮助我高效推进研究并解决多个实际问题，为后续从事计算机图形学相关研究奠定了坚实基础。

